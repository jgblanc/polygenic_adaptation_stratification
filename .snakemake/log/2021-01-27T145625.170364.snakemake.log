Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 4
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	aggregate_prs
	2	calc_prs
	2	calc_true_gv
	2	common_snp_freq
	1	concat_vcfs
	1	convert_vcf_to_plink
	1	create_panels_4PopSplit
	2	draw_effect_sizes
	20	format_VCF
	2	generate_genetic_values
	2	get_common_snp_list
	2	get_variant_freq
	2	gwas_no_correction
	2	pick_SNPS
	2	remake_panels_with_common_snps
	2	simulatate_phenotype_4PopSplit
	1	simulate_genotypes_4popsplit
	2	split_into_test_gwas
	2	test_snp_freq
	51

[Wed Jan 27 14:56:25 2021]
rule simulate_genotypes_4popsplit:
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_0.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_1.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_2.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_3.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_4.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_5.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_6.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_7.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_8.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_9.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_10.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_11.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_12.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_13.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_14.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_15.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_16.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_17.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_18.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_19.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos.pop
    jobid: 27
    wildcards: rep=V1

[Wed Jan 27 15:08:00 2021]
Finished job 27.
1 of 51 steps (2%) done

[Wed Jan 27 15:08:00 2021]
rule format_VCF:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos_17.vcf
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_17.ids.vcf.gz
    jobid: 48
    wildcards: model=4PopSplit, rep=V1, chr=17


[Wed Jan 27 15:08:00 2021]
rule format_VCF:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos_3.vcf
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_3.ids.vcf.gz
    jobid: 34
    wildcards: model=4PopSplit, rep=V1, chr=3


[Wed Jan 27 15:08:00 2021]
rule format_VCF:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos_14.vcf
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_14.ids.vcf.gz
    jobid: 45
    wildcards: model=4PopSplit, rep=V1, chr=14


[Wed Jan 27 15:08:00 2021]
rule format_VCF:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos_8.vcf
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_8.ids.vcf.gz
    jobid: 39
    wildcards: model=4PopSplit, rep=V1, chr=8

[Wed Jan 27 15:08:00 2021]
Error in rule format_VCF:
    jobid: 48
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_17.ids.vcf.gz
    shell:
        
	      head -n6 output/Simulate_Genotypes/4PopSplit/V1/genos_17.vcf > output/Simulate_Genotypes/4PopSplit/V1/header_17.txt
	      cat output/Simulate_Genotypes/4PopSplit/V1/header_17.txt <(cat output/Simulate_Genotypes/4PopSplit/V1/genos_17.vcf | awk -v OFS="	" 'NR>6 {$3=$1"_"$2"_A_T";$4="A"; $5="T"; print ;}') | bgzip > output/Simulate_Genotypes/4PopSplit/V1/genos_17.ids.vcf.gz
	      #bcftools index output/Simulate_Genotypes/4PopSplit/V1/genos_17.ids.vcf.gz
	      rm output/Simulate_Genotypes/4PopSplit/V1/header_17.txt
	      
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job format_VCF since they might be corrupted:
output/Simulate_Genotypes/4PopSplit/V1/genos_17.ids.vcf.gz
[Wed Jan 27 15:08:00 2021]
Error in rule format_VCF:
    jobid: 34
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_3.ids.vcf.gz
    shell:
        
	      head -n6 output/Simulate_Genotypes/4PopSplit/V1/genos_3.vcf > output/Simulate_Genotypes/4PopSplit/V1/header_3.txt
	      cat output/Simulate_Genotypes/4PopSplit/V1/header_3.txt <(cat output/Simulate_Genotypes/4PopSplit/V1/genos_3.vcf | awk -v OFS="	" 'NR>6 {$3=$1"_"$2"_A_T";$4="A"; $5="T"; print ;}') | bgzip > output/Simulate_Genotypes/4PopSplit/V1/genos_3.ids.vcf.gz
	      #bcftools index output/Simulate_Genotypes/4PopSplit/V1/genos_3.ids.vcf.gz
	      rm output/Simulate_Genotypes/4PopSplit/V1/header_3.txt
	      
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job format_VCF since they might be corrupted:
output/Simulate_Genotypes/4PopSplit/V1/genos_3.ids.vcf.gz
[Wed Jan 27 15:08:00 2021]
Error in rule format_VCF:
    jobid: 45
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_14.ids.vcf.gz
    shell:
        
	      head -n6 output/Simulate_Genotypes/4PopSplit/V1/genos_14.vcf > output/Simulate_Genotypes/4PopSplit/V1/header_14.txt
	      cat output/Simulate_Genotypes/4PopSplit/V1/header_14.txt <(cat output/Simulate_Genotypes/4PopSplit/V1/genos_14.vcf | awk -v OFS="	" 'NR>6 {$3=$1"_"$2"_A_T";$4="A"; $5="T"; print ;}') | bgzip > output/Simulate_Genotypes/4PopSplit/V1/genos_14.ids.vcf.gz
	      #bcftools index output/Simulate_Genotypes/4PopSplit/V1/genos_14.ids.vcf.gz
	      rm output/Simulate_Genotypes/4PopSplit/V1/header_14.txt
	      
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job format_VCF since they might be corrupted:
output/Simulate_Genotypes/4PopSplit/V1/genos_14.ids.vcf.gz
[Wed Jan 27 15:08:00 2021]
Error in rule format_VCF:
    jobid: 39
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_8.ids.vcf.gz
    shell:
        
	      head -n6 output/Simulate_Genotypes/4PopSplit/V1/genos_8.vcf > output/Simulate_Genotypes/4PopSplit/V1/header_8.txt
	      cat output/Simulate_Genotypes/4PopSplit/V1/header_8.txt <(cat output/Simulate_Genotypes/4PopSplit/V1/genos_8.vcf | awk -v OFS="	" 'NR>6 {$3=$1"_"$2"_A_T";$4="A"; $5="T"; print ;}') | bgzip > output/Simulate_Genotypes/4PopSplit/V1/genos_8.ids.vcf.gz
	      #bcftools index output/Simulate_Genotypes/4PopSplit/V1/genos_8.ids.vcf.gz
	      rm output/Simulate_Genotypes/4PopSplit/V1/header_8.txt
	      
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job format_VCF since they might be corrupted:
output/Simulate_Genotypes/4PopSplit/V1/genos_8.ids.vcf.gz
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /project2/jjberg/jgblanc/polygenic_adaptation_stratification/.snakemake/log/2021-01-27T145625.170364.snakemake.log
