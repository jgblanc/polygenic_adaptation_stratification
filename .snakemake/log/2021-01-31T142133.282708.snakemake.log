Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 1
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	aggregate_genotypes
	1	aggregate_gwas
	2	common_snp_freq
	1	concat_vcfs
	1	convert_vcf_to_plink
	1	create_panels_4PopSplit
	2	draw_effect_sizes
	2	format_VCF
	2	generate_genetic_values
	2	get_common_snp_list
	2	get_variant_freq
	2	gwas_no_correction
	2	remake_panels_with_common_snps
	2	run_PCA
	2	simulatate_phenotype_4PopSplit
	1	simulate_genotypes_4popsplit
	2	split_into_test_gwas
	28

[Sun Jan 31 14:21:33 2021]
rule simulate_genotypes_4popsplit:
    output: output/Simulate_Genotypes/4PopSplit/S1/genos_0.vcf, output/Simulate_Genotypes/4PopSplit/S1/genos_1.vcf, output/Simulate_Genotypes/4PopSplit/S1/genos.pop
    jobid: 14
    wildcards: rep=S1

[Sun Jan 31 14:21:51 2021]
Finished job 14.
1 of 28 steps (4%) done

[Sun Jan 31 14:21:51 2021]
rule format_VCF:
    input: output/Simulate_Genotypes/4PopSplit/S1/genos_0.vcf
    output: output/Simulate_Genotypes/4PopSplit/S1/genos_0.ids.vcf.gz
    jobid: 26
    wildcards: model=4PopSplit, rep=S1, chr=0

[Sun Jan 31 14:21:56 2021]
Finished job 26.
2 of 28 steps (7%) done

[Sun Jan 31 14:21:56 2021]
rule format_VCF:
    input: output/Simulate_Genotypes/4PopSplit/S1/genos_1.vcf
    output: output/Simulate_Genotypes/4PopSplit/S1/genos_1.ids.vcf.gz
    jobid: 27
    wildcards: model=4PopSplit, rep=S1, chr=1

[Sun Jan 31 14:22:00 2021]
Finished job 27.
3 of 28 steps (11%) done

[Sun Jan 31 14:22:00 2021]
rule concat_vcfs:
    input: output/Simulate_Genotypes/4PopSplit/S1/genos_0.ids.vcf.gz, output/Simulate_Genotypes/4PopSplit/S1/genos_1.ids.vcf.gz
    output: output/Simulate_Genotypes/4PopSplit/S1/genos.ids.vcf.gz
    jobid: 25
    wildcards: model=4PopSplit, rep=S1

[Sun Jan 31 14:22:02 2021]
Finished job 25.
4 of 28 steps (14%) done

[Sun Jan 31 14:22:02 2021]
rule convert_vcf_to_plink:
    input: output/Simulate_Genotypes/4PopSplit/S1/genos.ids.vcf.gz
    output: output/Simulate_Genotypes/4PopSplit/S1/genos.psam, output/Simulate_Genotypes/4PopSplit/S1/genos.pgen, output/Simulate_Genotypes/4PopSplit/S1/genos.pvar
    jobid: 20
    wildcards: model=4PopSplit, rep=S1

[Sun Jan 31 14:22:02 2021]
Finished job 20.
5 of 28 steps (18%) done

[Sun Jan 31 14:22:02 2021]
rule create_panels_4PopSplit:
    input: output/Simulate_Genotypes/4PopSplit/S1/genos.pop
    output: output/Simulate_Genotypes/4PopSplit/S1/C1/ids.gwas, output/Simulate_Genotypes/4PopSplit/S1/C1/ids.test, output/Simulate_Genotypes/4PopSplit/S1/C2/ids.gwas, output/Simulate_Genotypes/4PopSplit/S1/C2/ids.test
    jobid: 19
    wildcards: model=4PopSplit, rep=S1

[Sun Jan 31 14:22:03 2021]
Finished job 19.
6 of 28 steps (21%) done

[Sun Jan 31 14:22:03 2021]
rule split_into_test_gwas:
    input: output/Simulate_Genotypes/4PopSplit/S1/C2/ids.gwas, output/Simulate_Genotypes/4PopSplit/S1/C2/ids.test, output/Simulate_Genotypes/4PopSplit/S1/genos.psam, output/Simulate_Genotypes/4PopSplit/S1/genos.pvar, output/Simulate_Genotypes/4PopSplit/S1/genos.pgen
    output: output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test.psam, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas.pgen, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas.pvar
    jobid: 16
    wildcards: model=4PopSplit, rep=S1, config=C2

[Sun Jan 31 14:22:03 2021]
Finished job 16.
7 of 28 steps (25%) done

[Sun Jan 31 14:22:03 2021]
rule split_into_test_gwas:
    input: output/Simulate_Genotypes/4PopSplit/S1/C1/ids.gwas, output/Simulate_Genotypes/4PopSplit/S1/C1/ids.test, output/Simulate_Genotypes/4PopSplit/S1/genos.psam, output/Simulate_Genotypes/4PopSplit/S1/genos.pvar, output/Simulate_Genotypes/4PopSplit/S1/genos.pgen
    output: output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test.psam, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas.pgen, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas.pvar
    jobid: 12
    wildcards: model=4PopSplit, rep=S1, config=C1

[Sun Jan 31 14:22:03 2021]
Finished job 12.
8 of 28 steps (29%) done

[Sun Jan 31 14:22:03 2021]
rule get_variant_freq:
    input: output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test.psam, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test.pgen
    output: output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas.afreq
    jobid: 18
    wildcards: model=4PopSplit, rep=S1, config=C1

[Sun Jan 31 14:22:03 2021]
Finished job 18.
9 of 28 steps (32%) done

[Sun Jan 31 14:22:03 2021]
rule get_common_snp_list:
    input: output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas.afreq
    output: output/Simulate_Genotypes/4PopSplit/S1/C1/common_snp_ids.txt
    jobid: 11
    wildcards: model=4PopSplit, rep=S1, config=C1

[Sun Jan 31 14:22:04 2021]
Finished job 11.
10 of 28 steps (36%) done

[Sun Jan 31 14:22:04 2021]
rule remake_panels_with_common_snps:
    input: output/Simulate_Genotypes/4PopSplit/S1/C1/common_snp_ids.txt, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test.psam, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas.pvar, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas.pgen
    output: output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test_common.psam, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test_common.pvar, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test_common.pgen, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.pgen
    jobid: 5
    wildcards: model=4PopSplit, rep=S1, config=C1

[Sun Jan 31 14:22:04 2021]
Finished job 5.
11 of 28 steps (39%) done

[Sun Jan 31 14:22:04 2021]
rule get_variant_freq:
    input: output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test.psam, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test.pgen
    output: output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas.afreq
    jobid: 23
    wildcards: model=4PopSplit, rep=S1, config=C2

[Sun Jan 31 14:22:04 2021]
Finished job 23.
12 of 28 steps (43%) done

[Sun Jan 31 14:22:04 2021]
rule get_common_snp_list:
    input: output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas.afreq
    output: output/Simulate_Genotypes/4PopSplit/S1/C2/common_snp_ids.txt
    jobid: 15
    wildcards: model=4PopSplit, rep=S1, config=C2

[Sun Jan 31 14:22:05 2021]
Finished job 15.
13 of 28 steps (46%) done

[Sun Jan 31 14:22:05 2021]
rule remake_panels_with_common_snps:
    input: output/Simulate_Genotypes/4PopSplit/S1/C2/common_snp_ids.txt, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test.psam, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas.pvar, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas.pgen
    output: output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test_common.psam, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test_common.pvar, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test_common.pgen, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.pgen
    jobid: 8
    wildcards: model=4PopSplit, rep=S1, config=C2

[Sun Jan 31 14:22:05 2021]
Finished job 8.
14 of 28 steps (50%) done

[Sun Jan 31 14:22:05 2021]
rule common_snp_freq:
    input: output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.pgen
    output: output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.afreq
    jobid: 6
    wildcards: model=4PopSplit, rep=S1, config=C1

[Sun Jan 31 14:22:05 2021]
Finished job 6.
15 of 28 steps (54%) done

[Sun Jan 31 14:22:05 2021]
rule run_PCA:
    input: output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.pgen
    output: output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.eigenvec
    jobid: 3
    wildcards: model=4PopSplit, rep=S1, config=C1

[Sun Jan 31 14:22:05 2021]
Finished job 3.
16 of 28 steps (57%) done

[Sun Jan 31 14:22:05 2021]
rule run_PCA:
    input: output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.pgen
    output: output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.eigenvec
    jobid: 4
    wildcards: model=4PopSplit, rep=S1, config=C2

[Sun Jan 31 14:22:05 2021]
Finished job 4.
17 of 28 steps (61%) done

[Sun Jan 31 14:22:05 2021]
rule common_snp_freq:
    input: output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.pgen
    output: output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.afreq
    jobid: 9
    wildcards: model=4PopSplit, rep=S1, config=C2

[Sun Jan 31 14:22:05 2021]
Finished job 9.
18 of 28 steps (64%) done

[Sun Jan 31 14:22:05 2021]
rule aggregate_genotypes:
    input: output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.afreq, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.afreq, output/Simulate_Genotypes/4PopSplit/S1/genos_0.vcf, output/Simulate_Genotypes/4PopSplit/S1/genos_1.vcf, output/Simulate_Genotypes/4PopSplit/S1/genos_0.ids.vcf.gz, output/Simulate_Genotypes/4PopSplit/S1/genos_1.ids.vcf.gz, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas.afreq, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas.afreq, output/Simulate_Genotypes/4PopSplit/S1/genos.ids.vcf.gz, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas.pgen, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas.pgen, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas.pvar, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas.pvar, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-test.psam, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-test.psam, output/Simulate_Genotypes/4PopSplit/S1/genos.pgen, output/Simulate_Genotypes/4PopSplit/S1/genos.pvar, output/Simulate_Genotypes/4PopSplit/S1/genos.psam
    output: output/Simulate_Genotypes/4PopSplit/S1/ff.txt
    jobid: 21

[Sun Jan 31 14:22:06 2021]
Finished job 21.
19 of 28 steps (68%) done

[Sun Jan 31 14:22:06 2021]
rule draw_effect_sizes:
    input: output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.afreq
    output: output/Simulate_Phenotypes/4PopSplit/S1/C1/genos-gwas_common.effects.txt
    jobid: 22
    wildcards: model=4PopSplit, rep=S1, config=C1

[Sun Jan 31 14:22:07 2021]
Finished job 22.
20 of 28 steps (71%) done

[Sun Jan 31 14:22:07 2021]
rule generate_genetic_values:
    input: output/Simulate_Genotypes/4PopSplit/S1/ff.txt, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.pgen, output/Simulate_Phenotypes/4PopSplit/S1/C1/genos-gwas_common.effects.txt
    output: output/Simulate_Phenotypes/4PopSplit/S1/C1/genos-gwas_common.gvalue.sscore
    jobid: 13
    wildcards: model=4PopSplit, rep=S1, config=C1

[Sun Jan 31 14:22:07 2021]
Finished job 13.
21 of 28 steps (75%) done

[Sun Jan 31 14:22:07 2021]
rule draw_effect_sizes:
    input: output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.afreq
    output: output/Simulate_Phenotypes/4PopSplit/S1/C2/genos-gwas_common.effects.txt
    jobid: 24
    wildcards: model=4PopSplit, rep=S1, config=C2

[Sun Jan 31 14:22:08 2021]
Finished job 24.
22 of 28 steps (79%) done

[Sun Jan 31 14:22:08 2021]
rule generate_genetic_values:
    input: output/Simulate_Genotypes/4PopSplit/S1/ff.txt, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/S1/C2/genos-gwas_common.pgen, output/Simulate_Phenotypes/4PopSplit/S1/C2/genos-gwas_common.effects.txt
    output: output/Simulate_Phenotypes/4PopSplit/S1/C2/genos-gwas_common.gvalue.sscore
    jobid: 17
    wildcards: model=4PopSplit, rep=S1, config=C2

[Sun Jan 31 14:22:08 2021]
Finished job 17.
23 of 28 steps (82%) done

[Sun Jan 31 14:22:08 2021]
rule simulatate_phenotype_4PopSplit:
    input: output/Simulate_Phenotypes/4PopSplit/S1/C1/genos-gwas_common.gvalue.sscore, output/Simulate_Genotypes/4PopSplit/S1/genos.pop
    output: output/Simulate_Phenotypes/4PopSplit/S1/C1/genos-gwas_common.phenos.txt
    jobid: 7
    wildcards: model=4PopSplit, rep=S1, config=C1

[Sun Jan 31 14:22:09 2021]
Finished job 7.
24 of 28 steps (86%) done

[Sun Jan 31 14:22:09 2021]
rule gwas_no_correction:
    input: output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.afreq, output/Simulate_Phenotypes/4PopSplit/S1/C1/genos-gwas_common.phenos.txt
    output: output/Run_GWAS/4PopSplit/S1/C1/genos-gwas_common.pheno_random.glm.linear, output/Run_GWAS/4PopSplit/S1/C1/genos-gwas_common.pheno_strat.glm.linear
    jobid: 1
    wildcards: model=4PopSplit, rep=S1, config=C1

[Sun Jan 31 14:22:09 2021]
Error in rule gwas_no_correction:
    jobid: 1
    output: output/Run_GWAS/4PopSplit/S1/C1/genos-gwas_common.pheno_random.glm.linear, output/Run_GWAS/4PopSplit/S1/C1/genos-gwas_common.pheno_strat.glm.linear
    shell:
        plink2         --pfile output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common         --read-freq output/Simulate_Genotypes/4PopSplit/S1/C1/genos-gwas_common.afreq         --glm allow-no-covars         --pheno output/Simulate_Phenotypes/4PopSplit/S1/C1/genos-gwas_common.phenos.txt         --pheno-name pheno_random,pheno_strat         --out output/Run_GWAS/4PopSplit/S1/C1/genos-gwas_common

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /Users/jenniferblanc/polygenic_adaptation_stratification/.snakemake/log/2021-01-31T142133.282708.snakemake.log
