Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 1
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	common_snp_freq
	1	concat_vcfs
	1	convert_vcf_to_plink
	1	create_panels_4PopSplit
	2	format_VCF
	1	get_common_snp_list
	1	get_variant_freq
	1	remake_panels_with_common_snps
	1	simulate_genotypes_4popsplit
	1	split_into_test_gwas
	11

[Wed Jan 20 10:59:40 2021]
rule simulate_genotypes_4popsplit:
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_0.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_1.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos.pop
    jobid: 7
    wildcards: model=4PopSplit, rep=V1

[Wed Jan 20 10:59:44 2021]
Finished job 7.
1 of 11 steps (9%) done

[Wed Jan 20 10:59:44 2021]
rule format_VCF:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos_0.vcf
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_0.ids.vcf.gz
    jobid: 9
    wildcards: model=4PopSplit, rep=V1, chr=0

Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/genos_0.vcf.
[Wed Jan 20 10:59:57 2021]
Finished job 9.
2 of 11 steps (18%) done

[Wed Jan 20 10:59:57 2021]
rule format_VCF:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos_1.vcf
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_1.ids.vcf.gz
    jobid: 10
    wildcards: model=4PopSplit, rep=V1, chr=1

Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/genos_1.vcf.
[Wed Jan 20 11:00:09 2021]
Finished job 10.
3 of 11 steps (27%) done

[Wed Jan 20 11:00:09 2021]
rule concat_vcfs:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos_0.ids.vcf.gz, output/Simulate_Genotypes/4PopSplit/V1/genos_1.ids.vcf.gz
    output: output/Simulate_Genotypes/4PopSplit/V1/genos.ids.vcf.gz
    jobid: 8
    wildcards: model=4PopSplit, rep=V1

Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/genos_0.ids.vcf.gz.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/genos_1.ids.vcf.gz.
[Wed Jan 20 11:00:11 2021]
Finished job 8.
4 of 11 steps (36%) done

[Wed Jan 20 11:00:11 2021]
rule convert_vcf_to_plink:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos.ids.vcf.gz
    output: output/Simulate_Genotypes/4PopSplit/V1/genos.psam, output/Simulate_Genotypes/4PopSplit/V1/genos.pgen, output/Simulate_Genotypes/4PopSplit/V1/genos.pvar
    jobid: 6
    wildcards: model=4PopSplit, rep=V1

Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/genos.ids.vcf.gz.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/genos.pgen.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/genos.pvar.
[Wed Jan 20 11:00:12 2021]
Finished job 6.
5 of 11 steps (45%) done

[Wed Jan 20 11:00:12 2021]
rule create_panels_4PopSplit:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos.pop
    output: output/Simulate_Genotypes/4PopSplit/V1/C1/ids.gwas, output/Simulate_Genotypes/4PopSplit/V1/C1/ids.test, output/Simulate_Genotypes/4PopSplit/V1/C2/ids.gwas, output/Simulate_Genotypes/4PopSplit/V1/C2/ids.test
    jobid: 5
    wildcards: model=4PopSplit, rep=V1

[Wed Jan 20 11:00:13 2021]
Finished job 5.
6 of 11 steps (55%) done

[Wed Jan 20 11:00:13 2021]
rule split_into_test_gwas:
    input: output/Simulate_Genotypes/4PopSplit/V1/C1/ids.gwas, output/Simulate_Genotypes/4PopSplit/V1/C1/ids.test, output/Simulate_Genotypes/4PopSplit/V1/genos.psam
    output: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pgen, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pvar
    jobid: 3
    wildcards: model=4PopSplit, rep=V1, config=C1

[Wed Jan 20 11:00:13 2021]
Error in rule split_into_test_gwas:
    jobid: 3
    output: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pgen, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pvar
    shell:
        
	      plink2 	      --keep output/Simulate_Genotypes/4PopSplit/V1/C1/ids.gwas 	      --make-pgen 	      --out output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas 	      --pfile output/Simulate_Genotypes/4PopSplit/V1/genos 	      --rm-dup exclude-all

        plink2         --keep output/Simulate_Genotypes/4PopSplit/V1/C1/ids.test         --make-pgen         --out output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test         --pfile output/Simulate_Genotypes/4PopSplit/V1/genos 	      --rm-dup exclude-all
	      

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /Users/jenniferblanc/polygenic_adaptation_stratification/.snakemake/log/2021-01-20T105940.395987.snakemake.log
