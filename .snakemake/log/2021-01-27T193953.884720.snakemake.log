Building DAG of jobs...
Job counts:
	count	jobs
	1	aggregate_genotypes
	2	common_snp_freq
	1	concat_vcfs
	1	convert_vcf_to_plink
	1	create_panels_4PopSplit
	2	format_VCF
	2	get_common_snp_list
	2	get_variant_freq
	2	remake_panels_with_common_snps
	1	simulate_genotypes_4popsplit
	2	split_into_test_gwas
	17

[Wed Jan 27 19:39:54 2021]
rule simulate_genotypes_4popsplit:
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_0.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_1.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos.pop
    jobid: 3
    wildcards: rep=V1

python code/Simulate_Genotypes/generate_genotypes_4PopSplit.py 	       --outpre output/Simulate_Genotypes/4PopSplit/V1/genos 	       --chr 2 	       --Nanc 40000 	       -a 100 	       -b 100 	       -c 100 	       -d 100

[Wed Jan 27 19:39:54 2021]
rule format_VCF:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos_1.vcf
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_1.ids.vcf.gz
    jobid: 5
    wildcards: model=4PopSplit, rep=V1, chr=1


	      head -n6 output/Simulate_Genotypes/4PopSplit/V1/genos_1.vcf > output/Simulate_Genotypes/4PopSplit/V1/header_1.txt
	      cat output/Simulate_Genotypes/4PopSplit/V1/header_1.txt <(cat output/Simulate_Genotypes/4PopSplit/V1/genos_1.vcf | awk -v OFS="	" 'NR>6 {$3=$1"_"$2"_A_T";$4="A"; $5="T"; print ;}') | bgzip > output/Simulate_Genotypes/4PopSplit/V1/genos_1.ids.vcf.gz
	      #bcftools index output/Simulate_Genotypes/4PopSplit/V1/genos_1.ids.vcf.gz
	      rm output/Simulate_Genotypes/4PopSplit/V1/header_1.txt
	      

[Wed Jan 27 19:39:54 2021]
rule create_panels_4PopSplit:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos.pop
    output: output/Simulate_Genotypes/4PopSplit/V1/C1/ids.gwas, output/Simulate_Genotypes/4PopSplit/V1/C1/ids.test, output/Simulate_Genotypes/4PopSplit/V1/C2/ids.gwas, output/Simulate_Genotypes/4PopSplit/V1/C2/ids.test
    jobid: 14
    wildcards: model=4PopSplit, rep=V1

[Wed Jan 27 19:39:54 2021]
rule format_VCF:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos_0.vcf
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_0.ids.vcf.gz
    jobid: 4
    wildcards: model=4PopSplit, rep=V1, chr=0


	      head -n6 output/Simulate_Genotypes/4PopSplit/V1/genos_0.vcf > output/Simulate_Genotypes/4PopSplit/V1/header_0.txt
	      cat output/Simulate_Genotypes/4PopSplit/V1/header_0.txt <(cat output/Simulate_Genotypes/4PopSplit/V1/genos_0.vcf | awk -v OFS="	" 'NR>6 {$3=$1"_"$2"_A_T";$4="A"; $5="T"; print ;}') | bgzip > output/Simulate_Genotypes/4PopSplit/V1/genos_0.ids.vcf.gz
	      #bcftools index output/Simulate_Genotypes/4PopSplit/V1/genos_0.ids.vcf.gz
	      rm output/Simulate_Genotypes/4PopSplit/V1/header_0.txt
	      

[Wed Jan 27 19:39:54 2021]
rule concat_vcfs:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos_0.ids.vcf.gz, output/Simulate_Genotypes/4PopSplit/V1/genos_1.ids.vcf.gz
    output: output/Simulate_Genotypes/4PopSplit/V1/genos.ids.vcf.gz
    jobid: 8
    wildcards: model=4PopSplit, rep=V1

bcftools concat output/Simulate_Genotypes/4PopSplit/V1/genos_0.ids.vcf.gz output/Simulate_Genotypes/4PopSplit/V1/genos_1.ids.vcf.gz -o output/Simulate_Genotypes/4PopSplit/V1/genos.ids.vcf.gz -O z

[Wed Jan 27 19:39:54 2021]
rule convert_vcf_to_plink:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos.ids.vcf.gz
    output: output/Simulate_Genotypes/4PopSplit/V1/genos.psam, output/Simulate_Genotypes/4PopSplit/V1/genos.pgen, output/Simulate_Genotypes/4PopSplit/V1/genos.pvar
    jobid: 11
    wildcards: model=4PopSplit, rep=V1

plink2         --double-id         --make-pgen         --out output/Simulate_Genotypes/4PopSplit/V1/genos         --vcf output/Simulate_Genotypes/4PopSplit/V1/genos.ids.vcf.gz

[Wed Jan 27 19:39:54 2021]
rule split_into_test_gwas:
    input: output/Simulate_Genotypes/4PopSplit/V1/C1/ids.gwas, output/Simulate_Genotypes/4PopSplit/V1/C1/ids.test, output/Simulate_Genotypes/4PopSplit/V1/genos.psam, output/Simulate_Genotypes/4PopSplit/V1/genos.pvar, output/Simulate_Genotypes/4PopSplit/V1/genos.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pgen, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pvar
    jobid: 9
    wildcards: model=4PopSplit, rep=V1, config=C1


	      plink2 	      --keep output/Simulate_Genotypes/4PopSplit/V1/C1/ids.gwas 	      --make-pgen 	      --out output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas 	      --pfile output/Simulate_Genotypes/4PopSplit/V1/genos 	      --rm-dup exclude-all

        plink2         --keep output/Simulate_Genotypes/4PopSplit/V1/C1/ids.test         --make-pgen         --out output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test         --pfile output/Simulate_Genotypes/4PopSplit/V1/genos 	      --rm-dup exclude-all
	      

[Wed Jan 27 19:39:54 2021]
rule split_into_test_gwas:
    input: output/Simulate_Genotypes/4PopSplit/V1/C2/ids.gwas, output/Simulate_Genotypes/4PopSplit/V1/C2/ids.test, output/Simulate_Genotypes/4PopSplit/V1/genos.psam, output/Simulate_Genotypes/4PopSplit/V1/genos.pvar, output/Simulate_Genotypes/4PopSplit/V1/genos.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.pgen, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.pvar
    jobid: 10
    wildcards: model=4PopSplit, rep=V1, config=C2


	      plink2 	      --keep output/Simulate_Genotypes/4PopSplit/V1/C2/ids.gwas 	      --make-pgen 	      --out output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas 	      --pfile output/Simulate_Genotypes/4PopSplit/V1/genos 	      --rm-dup exclude-all

        plink2         --keep output/Simulate_Genotypes/4PopSplit/V1/C2/ids.test         --make-pgen         --out output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test         --pfile output/Simulate_Genotypes/4PopSplit/V1/genos 	      --rm-dup exclude-all
	      

[Wed Jan 27 19:39:54 2021]
rule get_variant_freq:
    input: output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.afreq
    jobid: 7
    wildcards: model=4PopSplit, rep=V1, config=C2


        plink2 	      --pfile output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test 	      --freq 	      --out output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test

	      plink2         --pfile output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas         --freq         --out output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas
        

[Wed Jan 27 19:39:54 2021]
rule get_variant_freq:
    input: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.afreq
    jobid: 6
    wildcards: model=4PopSplit, rep=V1, config=C1


        plink2 	      --pfile output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test 	      --freq 	      --out output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test

	      plink2         --pfile output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas         --freq         --out output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas
        

[Wed Jan 27 19:39:54 2021]
rule get_common_snp_list:
    input: output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.afreq
    output: output/Simulate_Genotypes/4PopSplit/V1/C2/common_snp_ids.txt
    jobid: 16
    wildcards: model=4PopSplit, rep=V1, config=C2

[Wed Jan 27 19:39:54 2021]
rule get_common_snp_list:
    input: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.afreq
    output: output/Simulate_Genotypes/4PopSplit/V1/C1/common_snp_ids.txt
    jobid: 15
    wildcards: model=4PopSplit, rep=V1, config=C1

[Wed Jan 27 19:39:54 2021]
rule remake_panels_with_common_snps:
    input: output/Simulate_Genotypes/4PopSplit/V1/C1/common_snp_ids.txt, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test_common.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test_common.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test_common.pgen, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.pgen
    jobid: 12
    wildcards: model=4PopSplit, rep=V1, config=C1


        plink2         --pfile output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test         --extract output/Simulate_Genotypes/4PopSplit/V1/C1/common_snp_ids.txt         --out output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test_common 	      --make-pgen

        plink2         --pfile output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas         --extract output/Simulate_Genotypes/4PopSplit/V1/C1/common_snp_ids.txt         --out output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common 	      --make-pgen
        

[Wed Jan 27 19:39:54 2021]
rule remake_panels_with_common_snps:
    input: output/Simulate_Genotypes/4PopSplit/V1/C2/common_snp_ids.txt, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test_common.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test_common.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test_common.pgen, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.pgen
    jobid: 13
    wildcards: model=4PopSplit, rep=V1, config=C2


        plink2         --pfile output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test         --extract output/Simulate_Genotypes/4PopSplit/V1/C2/common_snp_ids.txt         --out output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test_common 	      --make-pgen

        plink2         --pfile output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas         --extract output/Simulate_Genotypes/4PopSplit/V1/C2/common_snp_ids.txt         --out output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common 	      --make-pgen
        

[Wed Jan 27 19:39:54 2021]
rule common_snp_freq:
    input: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.afreq
    jobid: 1
    wildcards: model=4PopSplit, rep=V1, config=C1

plink2 	      --pfile output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common 	      --out output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common 	      --freq

[Wed Jan 27 19:39:54 2021]
rule common_snp_freq:
    input: output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.afreq
    jobid: 2
    wildcards: model=4PopSplit, rep=V1, config=C2

plink2 	      --pfile output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common 	      --out output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common 	      --freq

[Wed Jan 27 19:39:54 2021]
rule aggregate_genotypes:
    input: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.afreq, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.afreq, output/Simulate_Genotypes/4PopSplit/V1/genos_0.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_1.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos_0.ids.vcf.gz, output/Simulate_Genotypes/4PopSplit/V1/genos_1.ids.vcf.gz, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.afreq, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.afreq, output/Simulate_Genotypes/4PopSplit/V1/genos.ids.vcf.gz, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pgen, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.pgen, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/genos.pgen, output/Simulate_Genotypes/4PopSplit/V1/genos.pvar, output/Simulate_Genotypes/4PopSplit/V1/genos.psam
    jobid: 0

RuleException in line 181 of /project2/jjberg/jgblanc/polygenic_adaptation_stratification/snakefile:
'InputFiles' object has no attribute 'test_psam'
  File "/home/jgblanc/.local/lib/python3.7/site-packages/snakemake/executors/__init__.py", line 115, in run_jobs
  File "/home/jgblanc/.local/lib/python3.7/site-packages/snakemake/executors/__init__.py", line 120, in run
  File "/home/jgblanc/.local/lib/python3.7/site-packages/snakemake/executors/__init__.py", line 131, in _run
  File "/home/jgblanc/.local/lib/python3.7/site-packages/snakemake/executors/__init__.py", line 151, in printjob
  File "/home/jgblanc/.local/lib/python3.7/site-packages/snakemake/executors/__init__.py", line 137, in printjob
