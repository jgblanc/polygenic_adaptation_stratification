Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	aggregate_genotypes
	2	common_snp_freq
	1	concat_vcfs
	1	convert_vcf_to_plink
	1	create_panels_4PopSplit
	1	format_VCF
	2	get_common_snp_list
	2	get_variant_freq
	2	remake_panels_with_common_snps
	1	simulate_genotypes_4popsplit
	2	split_into_test_gwas
	16

[Wed Jan 27 12:59:21 2021]
rule simulate_genotypes_4popsplit:
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_0.vcf, output/Simulate_Genotypes/4PopSplit/V1/genos.pop
    jobid: 13
    wildcards: rep=V1

[Wed Jan 27 12:59:42 2021]
Finished job 13.
1 of 16 steps (6%) done

[Wed Jan 27 12:59:42 2021]
rule format_VCF:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos_0.vcf
    output: output/Simulate_Genotypes/4PopSplit/V1/genos_0.ids.vcf.gz
    jobid: 15
    wildcards: model=4PopSplit, rep=V1, chr=0

Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/genos_0.vcf.
[Wed Jan 27 12:59:44 2021]
Finished job 15.
2 of 16 steps (12%) done

[Wed Jan 27 12:59:44 2021]
rule concat_vcfs:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos_0.ids.vcf.gz
    output: output/Simulate_Genotypes/4PopSplit/V1/genos.ids.vcf.gz
    jobid: 14
    wildcards: model=4PopSplit, rep=V1

Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/genos_0.ids.vcf.gz.
[Wed Jan 27 12:59:46 2021]
Finished job 14.
3 of 16 steps (19%) done

[Wed Jan 27 12:59:46 2021]
rule convert_vcf_to_plink:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos.ids.vcf.gz
    output: output/Simulate_Genotypes/4PopSplit/V1/genos.psam, output/Simulate_Genotypes/4PopSplit/V1/genos.pgen, output/Simulate_Genotypes/4PopSplit/V1/genos.pvar
    jobid: 11
    wildcards: model=4PopSplit, rep=V1

Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/genos.ids.vcf.gz.
[Wed Jan 27 12:59:47 2021]
Finished job 11.
4 of 16 steps (25%) done

[Wed Jan 27 12:59:48 2021]
rule create_panels_4PopSplit:
    input: output/Simulate_Genotypes/4PopSplit/V1/genos.pop
    output: output/Simulate_Genotypes/4PopSplit/V1/C1/ids.gwas, output/Simulate_Genotypes/4PopSplit/V1/C1/ids.test, output/Simulate_Genotypes/4PopSplit/V1/C2/ids.gwas, output/Simulate_Genotypes/4PopSplit/V1/C2/ids.test
    jobid: 10
    wildcards: model=4PopSplit, rep=V1

[Wed Jan 27 12:59:48 2021]
Finished job 10.
5 of 16 steps (31%) done

[Wed Jan 27 12:59:49 2021]
rule split_into_test_gwas:
    input: output/Simulate_Genotypes/4PopSplit/V1/C1/ids.gwas, output/Simulate_Genotypes/4PopSplit/V1/C1/ids.test, output/Simulate_Genotypes/4PopSplit/V1/genos.psam, output/Simulate_Genotypes/4PopSplit/V1/genos.pvar, output/Simulate_Genotypes/4PopSplit/V1/genos.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pgen, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pvar
    jobid: 6
    wildcards: model=4PopSplit, rep=V1, config=C1

[Wed Jan 27 12:59:49 2021]
Finished job 6.
6 of 16 steps (38%) done

[Wed Jan 27 12:59:49 2021]
rule split_into_test_gwas:
    input: output/Simulate_Genotypes/4PopSplit/V1/C2/ids.gwas, output/Simulate_Genotypes/4PopSplit/V1/C2/ids.test, output/Simulate_Genotypes/4PopSplit/V1/genos.psam, output/Simulate_Genotypes/4PopSplit/V1/genos.pvar, output/Simulate_Genotypes/4PopSplit/V1/genos.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.pgen, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.pvar
    jobid: 8
    wildcards: model=4PopSplit, rep=V1, config=C2

Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/genos.pvar.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/genos.pgen.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/genos.psam.
[Wed Jan 27 12:59:49 2021]
Finished job 8.
7 of 16 steps (44%) done

[Wed Jan 27 12:59:49 2021]
rule get_variant_freq:
    input: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.afreq
    jobid: 9
    wildcards: model=4PopSplit, rep=V1, config=C1

[Wed Jan 27 12:59:49 2021]
Finished job 9.
8 of 16 steps (50%) done

[Wed Jan 27 12:59:50 2021]
rule get_common_snp_list:
    input: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.afreq
    output: output/Simulate_Genotypes/4PopSplit/V1/C1/common_snp_ids.txt
    jobid: 5
    wildcards: model=4PopSplit, rep=V1, config=C1

Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.afreq.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.afreq.
[Wed Jan 27 12:59:50 2021]
Finished job 5.
9 of 16 steps (56%) done

[Wed Jan 27 12:59:50 2021]
rule remake_panels_with_common_snps:
    input: output/Simulate_Genotypes/4PopSplit/V1/C1/common_snp_ids.txt, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test_common.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test_common.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test_common.pgen, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.pgen
    jobid: 3
    wildcards: model=4PopSplit, rep=V1, config=C1

Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pvar.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.psam.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.pgen.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pgen.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas.pvar.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C1/genos-test.psam.
[Wed Jan 27 12:59:51 2021]
Finished job 3.
10 of 16 steps (62%) done

[Wed Jan 27 12:59:51 2021]
rule get_variant_freq:
    input: output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.afreq
    jobid: 12
    wildcards: model=4PopSplit, rep=V1, config=C2

[Wed Jan 27 12:59:51 2021]
Finished job 12.
11 of 16 steps (69%) done

[Wed Jan 27 12:59:51 2021]
rule get_common_snp_list:
    input: output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.afreq, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.afreq
    output: output/Simulate_Genotypes/4PopSplit/V1/C2/common_snp_ids.txt
    jobid: 7
    wildcards: model=4PopSplit, rep=V1, config=C2

Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.afreq.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.afreq.
[Wed Jan 27 12:59:52 2021]
Finished job 7.
12 of 16 steps (75%) done

[Wed Jan 27 12:59:52 2021]
rule remake_panels_with_common_snps:
    input: output/Simulate_Genotypes/4PopSplit/V1/C2/common_snp_ids.txt, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pgen, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test_common.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test_common.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test_common.pgen, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.pgen
    jobid: 4
    wildcards: model=4PopSplit, rep=V1, config=C2

Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.psam.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.pvar.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pvar.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.pgen.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas.psam.
Removing temporary output file output/Simulate_Genotypes/4PopSplit/V1/C2/genos-test.pgen.
[Wed Jan 27 12:59:52 2021]
Finished job 4.
13 of 16 steps (81%) done

[Wed Jan 27 12:59:52 2021]
rule common_snp_freq:
    input: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.afreq
    jobid: 1
    wildcards: model=4PopSplit, rep=V1, config=C1

[Wed Jan 27 12:59:52 2021]
Finished job 1.
14 of 16 steps (88%) done

[Wed Jan 27 12:59:52 2021]
rule common_snp_freq:
    input: output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.psam, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.pvar, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.pgen
    output: output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.afreq
    jobid: 2
    wildcards: model=4PopSplit, rep=V1, config=C2

[Wed Jan 27 12:59:52 2021]
Finished job 2.
15 of 16 steps (94%) done

[Wed Jan 27 12:59:52 2021]
rule aggregate_genotypes:
    input: output/Simulate_Genotypes/4PopSplit/V1/C1/genos-gwas_common.afreq, output/Simulate_Genotypes/4PopSplit/V1/C2/genos-gwas_common.afreq
    jobid: 0

[Wed Jan 27 12:59:52 2021]
Finished job 0.
16 of 16 steps (100%) done
Complete log: /project2/jjberg/jgblanc/polygenic_adaptation_stratification/.snakemake/log/2021-01-27T125920.639822.snakemake.log
